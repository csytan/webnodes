{% extends "base.html" %}

{% load tag_extras %}
{% load recurse %}

{% block title %}
    <title>{{ topic.title }} | {{ forum }}</title>
{% endblock %}

{% block style %}
    <style>
        #content {
            width: 100%;
            max-width: 600px;
        }
        
    </style>
{% endblock %}


{% block script %}
    <script type="text/javascript">
        $(document).ready(function(){
            $('a.reply').live('click', function(e){
                $('#reply_to').val(this.id);
                return false;
            });
        });
    </script>
{% endblock %}



{% block content %}

    {% if tree %}
        {% recurse comment.replies with topic as comment %}
        <div id="comment{{comment.id}}" class="comment box">
            {% loop %}
                <span>
                    {{ comment.author }}
                    {{ comment.created }}
                    {{ comment.id }}
                </span>
                {{ comment.body|markdownify }}

                <a id="{{comment.id}}" href="#" class="reply">reply</a>
                <div class="replies">
                    {% child %}
                </div>
            {% endloop %}
        </div>
        {% endrecurse %}
    {% else %}
        {% for comment in comments %}
        <div class="comment" class="comment box">
            <span>
                {{ comment.author }}
                {{ comment.created }}
                {{ comment.id }}
            </span>
            {{ comment.body|markdownify }}
        <div>
        {% endfor %}
        
        
    {% endif %}

    <div id="reply_box" class="container">
        <div class="comment box" style="padding:0.5em;padding-bottom:0px">
            <form id="reply_form" action="" method="post">
                <input type="hidden" id="reply_to" name="reply_to">
                <textarea id="reply_textarea" name="body" style="height:200px; width:95%"></textarea>
                <input type="submit" style="float:right" value="reply">
                <span id="reply_cancel" class="button" style="float:left" href="#">cancel</span>
                <div style="clear:left"></div>
            </form>
        </div>
    </div>
{% endblock %}
